# 2025년 2월 12일
---
## 사실

### ELK kibana


## 발견

## 배운점(복습)
- 역색인
  - 단어에 문서 번호를 부여하는것이 아닌 단어마다 어떤 문서에 들어가 있는지를 기록.
    
- text : doc_values 캐시 사용.
  - 애널라이저가 적용된 후 색인된다. 들어온 문자열을 여러 토큰(조각)으로 쪼개어 역색인을 구성한다. 최종적으로 역색인에 들어가는 형태를 텀(term)이라고 한다.
- keyword : fielddata 캐시사용
  - 노멀라이저가 적용된 후 색인된다. 들어온 문자열을 여러 토큰으로 쪼개지 않고 역색인을 한다.
 
- doc_values (대부분의 필드타입이 사용)
  - 문서를 보고 필드 내의 텀을 찾는 디스크 기반으로 한 자료 구조로 파일 시스템 캐시를 통해 효율적인 정렬, 집계, 스크립트 작업을 수행.    
- fielddata  (text타입이 주로 사용)
  - 정렬, 집계등의 작업시 역색인 전체를 읽어 힙 메모리에 올리기에 OOM등의 문제가 발생 가능.
 
- _source
  - 문서 색인 시점 엘라스틱서치에 전달된 원본 JSON 문서를 저장하는 메타데이터필드. source필드 자체는 역색인을 생성하지 않기 때문에 검색 대상이 되지 않는다.
  - JSON문서를 통째로 담기 때문에 디스크를 많이 사용한다. 그래서 source에 데이터를 저장하지 않도록 설정할 수 있으나!
  - 엘라스틱서치의 세그먼트는 불변이라 업데이트 작업시 기존 문서를 삭제하고 새로운 문서를 다시 만드는데 source에 데이터가 없으면 업데이트를 할 수 없다.
  - reindex api도 사용불가하다.
    - source 비활성화보단 인덱스 데이터 압축률을 높이는 편을 강추!!! settings - index - codec에 best_compression으로 DEFLATE압축을 사용하라

- synthetic source
  - 사용시 source에 json원문 저장하지 않는다.
  - source를 읽어야 할 때 문서 내 각 필드의 doc_values를 모아 _source를 재조립해 동작한다.
  - 인덱스의 모든 필드가 doc_values를 사용하는 필드여야 하며 source를 읽어야 하는 작업의 성능은 떨어진다. 재조립된 원문도 json과 다를 수 있다.
  - reindex작업도 가능.

- index
  - 해당 필드의 역색인을 만들 것인지를 지정.
  - doc_vlaues를 사용할 경우 index  속성이 false여도 역색인 대신 doc_values를 이용해 검색을 수행. (doc_values는 검색을 위한 자료형이 아니여서 검색 성능이 떨어지지만 디스크공간 절약, 색인 성능을 기대할 수 있다.)

- enabled
  - object 타입 필드에만 적용되며 false일시 엘라스틱서치가 파싱조차 하지 않음. 검색도 정렬, 집계의 대상이 될 수도 없다.

text필드 데이터는 애널라이저를 통해 분석돼 여러 텀으로 쪼개져 색인된다.


  
## 선언


### kibana에 대하여 숙지한다.

s
